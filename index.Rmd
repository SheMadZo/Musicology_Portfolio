---
title: "The Art of Sampling"
author: "Sheila Damson"

output: 
  flexdashboard::flex_dashboard:
    storyboard: true
    orientation: columns
    vertical_layout: scroll
---

```{r}
library(flexdashboard) 
library(tidyverse)
library(spotifyr)
library(plotly) 
library(Cairo)
library(ggplot2)
library(compmus)
library(tidymodels)
library(ggdendro)
library(heatmaply)
```

Corpus
======================================================================

Column: {data-width=500}
----------------------------------------------------------------------

### Computational Musicology

```{r}
valueBox("Spotify Plylist and Song Links:")
```

### Playlists:

For this computational music analysis , I will use multible playlist and some specific songs:


[Amen Break](https://open.spotify.com/playlist/2lqu4jyqWFf3Rb883iiHdA?si=ddaa5103285f4ce4)
-> 36 songs that used the Amen break sample.

[Kanye West Songs](https://open.spotify.com/playlist/63JaJODHTMrM2a1KrfZg4B?si=da67498e93434f89)
-> 20 of my favorite Kanye-songs.

[Original Songs](https://open.spotify.com/playlist/4WWsSjvxySyyu6WBkhe6A9?si=6f0d5bfdb0a24fbd)
-> 20 original songs (same order as from playlist above).


### Specific Songs: (referenced later in the Portfolio):

[Amen Brother](https://open.spotify.com/track/32Rf95ZT8gxisQMK6xAhba?si=7d1ea499e22f492f)
-> Original Song of the Amen Break.

[Futurama Theme Song](https://open.spotify.com/track/7MDGp4UEjsMxCnASVy8J7O?si=421dc6e1adcb4607)
-> Sample of Amen Break.


### Special Sample:

[Silver Soul](https://open.spotify.com/track/56eSclzdXaWU5jOJ7DX7Vp?si=af923e96a2b9489c)
-> Original song by Beach House.

[Money Trees](https://open.spotify.com/track/0UtnpKaReKUg2GquaSxCyD?si=8c0337abb0cf46ca)
-> Sample Song of 'Silver Soul'.

[Toxic Original](https://open.spotify.com/track/6I9VzXrHxO9rA9A5euc8Ak?si=032500a3a56e48e2)
-> 'Toxic' by Britney Spears.

[Toxic Sample](https://open.spotify.com/track/5Ojf9lZcyfylL1IsJ0qyB0?si=3ee57451bfc14f6d)
-> Donk- (genre from the UK) version of the original 'Toxic' by Britney Spears.



Column: {data-width=500}
----------------------------------------------------------------------

### Introduction

The Art of Sampling

[Sampling in sound and music is the reuse of a sound recording of an already other existing recording](https://en.wikipedia.org/wiki/Sampling_(music)). Whether the sample is derived from rhythm, melody, speech or sound of an already existing recording, there are many creative ways artist have established the art of sampling.


Why did I chose to base my Corpus around sampling?

I chose to base my corpus on sampling because, personally, I find it fascinating to observe how global music cultures influences each other. My intentions for this Portfolio were to analyse sample methods using computational tools. 

Structure of the Portfolio: (What are the songs/playlists I chose for my corpus?)

This portfolio will focus on two sub-parts of sampling:

1) The most sampled song (-part) and the songs that integrated the sample from the song. 

2) The king of sampling: How my appreciation towards Kanye West increased by investigating his art of sampling. 

(3) Special original and sample comparison: Silver Soul (by Beach House) vs. Money Trees (by Kendrick Lamar)) and others using Chormagrams.


Amen Break: {data-navmenu=Info}
======================================================================

Column: {data-width=400}
----------------------------------------------------------------------




Columns: {data-width=350}
----------------------------------------------------------------------

### Amen Break:

What is the Amen Break?

According to Wikipedia, the most ever sampled beat recorded (and acknowledged) in music history comes from the song "Amen Brother" by The Winstons. From the song minute 1.27 on, the probably six most important second in music begin. The drum-solo performed by Gregory C. Coleman, is what is known for the Amen Break. The amen Break is not only the most sampled beat but also depicts the The Golden Ratio in music. Even tough (and unfortunately) Gregory C. Coleman died homeless and without any money, his legacy continuous to shape the music industry. 

[What is The golden Ration in music?](https://www.cambridgeaudio.com/usa/en/blog/amen-break-six-important-seconds-music#:~:text=music%20you%20favour.-,You%20may%20not%20be%20aware%20of%20what%20the%20Amen%20Break,sampled%20beats%20of%20all%20time.) How can tools of Computational Musicology define the golden ration and identify the usage of the Amen Break in different samples? These question will be investigated through out the next couple of pages.

Column: {data-width=250}
----------------------------------------------------------------------

### Amen Break Samples

```{r}
valueBox(prettyNum("> 6000", big.mark = ","), caption = "Samples of the Amen Break")
```


Kanye West: {data-navmenu=Info}
======================================================================

Column: {data-width=250}
----------------------------------------------------------------------


Column: {data-width=500}
----------------------------------------------------------------------

### Kanye West:

Kanye West 

- Why did I chose him:

I started appreciating Kanye West and his art more and more over time. When ever he relieses new albums, I am looking forward to listen to the album during one session. Even though, he as a person might be controversial, I do think it os important in some aspects to seperate the art from the artist. 

- Expectations and Realizations to be continued on the other pages:

Since Kanye's way of sampling is so diverse, I do not expect to be able to identify pattern in the sample selection of his. I hope to be able to find similarities between the original songs and the sample songs using chromagrams and self-similarity matrices.

Column: {data-width=250}
----------------------------------------------------------------------



Amen Break Playlist
======================================================================

### Conclusions:

I wanted to investigate whether the clustering of the songs sampling the Amen Break would eventually lead back to the genres of the songs. Since the Amen Break has cultivated Hip Hop and and Drum & Bass (also most common in the playlist), I expected at least two equally large clusters. But the clustering methods appeared to be not as successful as expected. This was concluded because neither average and complete linkage were able to detect clear clustering. (I wanted to change my corpus but I ran out of time).

 

### Clustering of Amen Break Samples using Average linkage:

```{r}
# spotify:playlist:2lqu4jyqWFf3Rb883iiHdA

amenbreak <-
  get_playlist_audio_features("", "2lqu4jyqWFf3Rb883iiHdA") |>
  add_audio_analysis() |>
  mutate(
    segments = map2(segments, key, compmus_c_transpose),
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "mean", norm = "manhattan"
      ),
    timbre =
      map(
        segments,
        compmus_summarise, timbre,
        method = "mean"
      )
  ) |>
  mutate(pitches = map(pitches, compmus_normalise, "clr")) |>
  mutate_at(vars(pitches, timbre), map, bind_rows) |>
  unnest(cols = c(pitches, timbre))

break_juice <-
  recipe(
    track.name ~
      danceability +
      energy +
      loudness +
      speechiness +
      acousticness +
      instrumentalness +
      liveness +
      valence +
      tempo +
      duration +
      C + `C#|Db` + D + `D#|Eb` +
      E + `F` + `F#|Gb` + G +
      `G#|Ab` + A + `A#|Bb` + B +
      c01 + c02 + c03 + c04 + c05 + c06 +
      c07 + c08 + c09 + c10 + c11 + c12,
    data = amenbreak
  ) |>
  step_center(all_predictors()) |>
  step_scale(all_predictors()) |> 
  # step_range(all_predictors()) |> 
  prep(amenbreak |> mutate(track.name = str_trunc(track.name, 20))) |>
  juice() |>
  column_to_rownames("track.name")

break_dist <- dist(break_juice, method = "euclidean")

break_dist |> 
  hclust(method = "average") |> # Try single, average, and complete.
  dendro_data() |>
  ggdendrogram()
```


### Clustering using Complete linkage:

```{r}

amenbreak <-
  get_playlist_audio_features("", "2lqu4jyqWFf3Rb883iiHdA") |>
  add_audio_analysis() |>
  mutate(
    segments = map2(segments, key, compmus_c_transpose),
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "mean", norm = "manhattan"
      ),
    timbre =
      map(
        segments,
        compmus_summarise, timbre,
        method = "mean"
      )
  ) |>
  mutate(pitches = map(pitches, compmus_normalise, "clr")) |>
  mutate_at(vars(pitches, timbre), map, bind_rows) |>
  unnest(cols = c(pitches, timbre))

break_juice <-
  recipe(
    track.name ~
      danceability +
      energy +
      loudness +
      speechiness +
      acousticness +
      instrumentalness +
      liveness +
      valence +
      tempo +
      duration +
      C + `C#|Db` + D + `D#|Eb` +
      E + `F` + `F#|Gb` + G +
      `G#|Ab` + A + `A#|Bb` + B +
      c01 + c02 + c03 + c04 + c05 + c06 +
      c07 + c08 + c09 + c10 + c11 + c12,
    data = amenbreak
  ) |>
  step_center(all_predictors()) |>
  step_scale(all_predictors()) |> 
  # step_range(all_predictors()) |> 
  prep(amenbreak |> mutate(track.name = str_trunc(track.name, 20))) |>
  juice() |>
  column_to_rownames("track.name")

break_dist <- dist(break_juice, method = "euclidean")

break_dist |> 
  hclust(method = "complete") |> # Try single, average, and complete.
  dendro_data() |>
  ggdendrogram()
```

### Heatmap of Amen Break Playlist;

```{r}
heatmaply(
  break_juice,
  hclustfun = hclust,
  hclust_method = "average",  # Change for single, average, or complete linkage.
  dist_method = "euclidean"
)
```


Amen Break
======================================================================

Column: {data-width=700, .tabset}
----------------------------------------------------------------------

### Novelty Function of 'Amen Brother':

```{r}
# spotify:track:32Rf95ZT8gxisQMK6xAhba

Amen_Brother <-
  get_tidy_audio_analysis("32Rf95ZT8gxisQMK6xAhba") |>
  select(segments) |>
  unnest(segments)

# Amen_Brother2 <- Amen_Brother[293:327,] # 293:327

Amen_Brother|>
  mutate(pitches = map(pitches, compmus_normalise, "clr")) |>
  arrange(start) |>
  mutate(pitches = map2(pitches, lag(pitches), `-`)) |>
  slice(-1) |> 
  compmus_gather_chroma() |> 
  group_by(start, duration) |> 
  summarise(novelty = sum(log1p(pmax(value, 0)))) |> 
  ggplot(aes(x = start + duration / 2, y = novelty)) +
  geom_line() +
  xlim(0, 156) +
  theme_minimal() +
  labs(title = "Novelty Function of Amen Brother:", x = "Time (s)", y = "Novelty")
```

### Specific Amen Break part: 

```{r}
 Amen_Brother |>
  mutate(pitches = map(pitches, compmus_normalise, "clr")) |>
  arrange(start) |>
  mutate(pitches = map2(pitches, lag(pitches), `-`)) |>
  slice(-1) |> 
  compmus_gather_chroma() |> 
  group_by(start, duration) |> 
  summarise(novelty = sum(log1p(pmax(value, 0)))) |> 
  ggplot(aes(x = start + duration / 2, y = novelty)) +
  geom_line() +
  xlim(86, 94) +
  theme_minimal() +
  labs(title = "Novelty Function only of Amen Break (part of Amen Brother):", x = "Time (s)", y = "Novelty")
 
 Amen_Brother |>
  mutate(loudness_max_time = start + loudness_max_time) |>
  arrange(loudness_max_time) |>
  mutate(delta_loudness = loudness_max - lag(loudness_max)) |>
  ggplot(aes(x = loudness_max_time, y = pmax(0, delta_loudness))) +
  geom_line() +
  xlim(86, 94) +
  theme_minimal() +
  labs(title = "Novelty Function only of Amen Break (part of Amen Brother) based on loudness:",x = "Time (s)", y = "Novelty")
 
```

> 6 seconds of beat revolutionizing the music industry -> The Amen Break. 

### Tempogram:

```{r}
# spotify:track:32Rf95ZT8gxisQMK6xAhba

AB <- get_tidy_audio_analysis("32Rf95ZT8gxisQMK6xAhba")

AB |>
  tempogram(window_size = 8, hop_size = 1, cyclic = FALSE) |>
  ggplot(aes(x = time, y = bpm, fill = power)) +
  geom_raster() +
  scale_fill_viridis_c(guide = "none") +
  labs(x = "Time (s)", y = "Tempo (BPM)") +
  theme_classic()

# The diffrenece is cyclic = TRUE

AB |>
  tempogram(window_size = 8, hop_size = 1, cyclic = TRUE) |>
  ggplot(aes(x = time, y = bpm, fill = power)) +
  geom_raster() +
  scale_fill_viridis_c(guide = "none") +
  labs(x = "Time (s)", y = "Tempo (BPM)") +
  theme_classic()
```



Column: 
----------------------------------------------------------------------

### What is the Amen Break:

The "Amen break" is one of the most famous and widely used drum breaks in the history of music, particularly in the genres of hip hop, drum and bass, jungle, and breakbeat. It originates from a drum solo performed by the drummer Gregory Cylvester "G. C." Coleman in the song "Amen, Brother" by the soul and funk group The Winstons.


### Novelty Function:

First, you can see onset detection of the entire song "Amen Brother" by the Winstons. And the lower tempogram only represents onset detection of the Novelty Function of the part containing the Amen Break.

An attempt was made to use the Novelty Function to recreate the Golden Ratio from the interval between the 86th second and the 94th second of the song "Amen Brother" which contains the Amen Break.  

When using loudness as an indication, the Amen Break could be identified better (very subjective). This can be seen in the 3rd plot.

It was concluded that using the Novelty function to deduct the Golden Ratio of the Amen Break is not too usefull since it does not pick up on the Golden Ration of the onsets that define the Amen Break.

### Tempograms:

What can we deduct from the "Amen Brother" tempograms from the other column.

- The difference between the two tempograms of the other side is that the second one (cyclic = TRUE) uses cyclic wrapping (not picking up on tempo harmonics) and can thus be (sometimes) more informative. Even though neither of the tempograms can give us a clear indication of the "general tempo" of the song, we can detect in both tempograms where the Amen Break occurs (starting around 87th second on the x-achis).


Comparing Original vs. Sample Songs: {data-navmenu=Kanye}
=========================================================================

Column: {data-width=750}
-------------------------------------------------------------------------
### Playlist Comparison:

```{r}
# Samples: spotify:playlist:4WWsSjvxySyyu6WBkhe6A9

# kanye: spotify:playlist:63JaJODHTMrM2a1KrfZg4B

samples.k <- get_playlist_audio_features("", "4WWsSjvxySyyu6WBkhe6A9")
kanye <- get_playlist_audio_features("", "63JaJODHTMrM2a1KrfZg4B")

together <-
  bind_rows(
    samples.k |> mutate(category = "Original"),
    kanye |> mutate(category = "Kanye Sample")
  )


together |>
  mutate(
    mode = ifelse(mode == 0, "Minor", "Major")
  ) |>
  ggplot(
    aes(
      x = valence,
      y = energy,
      size = loudness,
      colour = mode
    )
  ) +
  geom_point() +
  geom_rug(linewidth = 0.1) +
  geom_text(
    aes(
      x = valence,
      y = energy,
      label = label
    ),
    data = 
      tibble(
        label = c("Original", "Kanye Sample"),
        category = c("Original", "Kanye Sample"),
        valence = c(0.104, 0.0339),
        energy = c(0.992, 0.00166)
      ),
    colour = "black",
    size = 3,
    hjust = "left",
    vjust = "center",
    nudge_x = 0.02
  ) +
  facet_wrap(~ category) +
  scale_x_continuous(
    limits = c(0, 1),
    breaks = c(0, 0.50, 1),
    minor_breaks = NULL
  ) +
  scale_y_continuous(
    limits = c(0, 1),
    breaks = c(0, 0.50, 1),
    minor_breaks = NULL
  ) +
  scale_colour_brewer(
    type = "qual",
    palette = "Paired"
  ) +
  scale_size_continuous(
    trans = "exp",
    name = "Loudness"  # Specify the title for the size legend
  ) +                      # Add a legend indicating the size defines the song's loudness
  theme_light() +
  labs(
    x = "Valence",
    y = "Energy",
    colour = "Mode"
  )
```

Column: {data-width=250}
----------------------------------------------------------------------------

It plot indicates that Kanye West gets inspired by different music all over the energy and valence spectrum.

Chroma Comparisons: {data-navmenu=Kanye}
================================================================================

Column: {data-width=500, .tabset}
--------------------------------------------------------------------------------

```{r}
valueBox("Original Songs:")
```


### 'My Song', Labi Siffre

```{r}
# My Song (original): spotify:track:2EQWbkcNoKPOXQtJM7nqRV

mysong <-
  get_tidy_audio_analysis("2EQWbkcNoKPOXQtJM7nqRV") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

mysong |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c()
```

Column: {data-width=500, .tabset}
-------------------------------------------------------------------------

```{r}
valueBox("Kanye's Samples:")
```


### Kanye Sample 'I wonder': 

```{r}
# Kanye - Wonder: spotify:track:7rbECVPkY5UODxoOUVKZnA

wonder <-
  get_tidy_audio_analysis("7rbECVPkY5UODxoOUVKZnA") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

wonder |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c()
```


Special Samples: {data-orientation=rows}
======================================================================

Row:
----------------------------------------------------------------------

### Introduction:

One of my favorite sample is "Money" Trees by Kendrick Lamar. At first I did not know that the song was a sample. By accident I found out that this song is a sample of the original song "Silver Soul" by Beach House. The sample consist of the main melodic motive (first part of the song "Silver Song") played backwards. Playing parts of a song reversed was used first by The Beatles and has been a sampling method ever since. 

Using Self-Similarity Matrixes of both songs, I hope to detect the same pattern of the Chroma features but reveresed in "Money Trees".

I also chose to compare wo other songs each with their samples:
- 'Toxic'- Britney Spears vs. 'Toxic'- Lobsta B
- 'Bound'- Panderosa Twins vs. 'Bound2'- Kanye West

I was a bit disappointed looking at the self-similarity matrices. I expected certain melodic similarities to be easy detectable comparing the right side and the left side...



Column: {data-width=500, .tabset} 
----------------------------------------------------------------------

### 'Silver Soul'- Beach House

```{r}
# spotify:track:56eSclzdXaWU5jOJ7DX7Vp

ss <-
  get_tidy_audio_analysis("56eSclzdXaWU5jOJ7DX7Vp") |> # Change URI.
  compmus_align(bars, segments) |>                     # Change `bars`
  select(bars) |>                                      #   in all three
  unnest(bars) |>                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )

ss |>
  compmus_self_similarity(timbre, "cosine") |> 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude")
```

### 'Toxic'- Britney Spears:

```{r}
# spotify:track:6I9VzXrHxO9rA9A5euc8Ak

toxic <-
  get_tidy_audio_analysis("6I9VzXrHxO9rA9A5euc8Ak") |> # Change URI.
  compmus_align(bars, segments) |>                     # Change `bars`
  select(bars) |>                                      #   in all three
  unnest(bars) |>                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )

toxic |>
  compmus_self_similarity(timbre, "cosine") |> 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude")
```


### 'Bound'- Ponderosa Twins:

```{r}
# spotify:track:0AqE2nClzllWavHbkC2AeZ

bound <-
  get_tidy_audio_analysis("0AqE2nClzllWavHbkC2AeZ") |> # Change URI.
  compmus_align(bars, segments) |>                     # Change `bars`
  select(bars) |>                                      #   in all three
  unnest(bars) |>                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )

bound |>
  compmus_self_similarity(timbre, "cosine") |> 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude")
```



Column: {data-width=500, .tabset}
----------------------------------------------------------------------

### 'Money Trees'- Kendrick Lamar:

```{r}
# spotify:track:0UtnpKaReKUg2GquaSxCyD

mt <-
  get_tidy_audio_analysis("0UtnpKaReKUg2GquaSxCyD") |> # Change URI.
  compmus_align(bars, segments) |>                     # Change `bars`
  select(bars) |>                                      #   in all three
  unnest(bars) |>                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )

mt |>
  compmus_self_similarity(timbre, "cosine") |> 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude")
```

### 'Toxic'- Lobsta B (sample):

```{r}
# spotify:track:5Ojf9lZcyfylL1IsJ0qyB0

donk <-
  get_tidy_audio_analysis("5Ojf9lZcyfylL1IsJ0qyB0") |> # Change URI.
  compmus_align(bars, segments) |>                     # Change `bars`
  select(bars) |>                                      #   in all three
  unnest(bars) |>                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )

donk |>
  compmus_self_similarity(timbre, "cosine") |> 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude")
```


### 'Bound2'- Kanye West:

```{r}
# spotify:track:3sNVsP50132BTNlImLx70i

bound2 <-
  get_tidy_audio_analysis("3sNVsP50132BTNlImLx70i") |> # Change URI.
  compmus_align(bars, segments) |>                     # Change `bars`
  select(bars) |>                                      #   in all three
  unnest(bars) |>                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )

bound2 |>
  compmus_self_similarity(timbre, "cosine") |> 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude")
```

