---
title: "Insert Title"
author: "Sheila Damson"

output: 
  flexdashboard::flex_dashboard:
    storyboard: true
    orientation: columns
    vertical_layout: scroll
---

```{r}
library(flexdashboard) 
library(tidyverse)
library(spotifyr)
library(plotly) 
library(Cairo)
library(ggplot2)
library(compmus)
```


Assignment Week 9:
======================================================================

Descriptive {data-width=250}
----------------------------------------------------------------------

Dear person to Peer review this page,
version for each Cepstrogram and Self-Similarity Matrix. I focused more on the layout of the page this week. It is not that great yet... But I will get there eventually.

Song 1: Ocelot of Salvation (Immortal Onion)

This song is a sudion Jazz song by a polish band. I chose the live version of this song because I liket it more than the sudio recorded version.  

Song 2:

Data.Matrix 

Song 3:

"insert title"

Cepstrogram {data-width=375, .tabset}
----------------------------------------------------------------------

### Song 1:

```{r}

# Course Lecture 3:


#spotify:track:7D4gttjv3ot3vuc8We5aVE

# Ocelot of Salvation

oos2 <-
  get_tidy_audio_analysis("7D4gttjv3ot3vuc8We5aVE") |> # Change URI.
  compmus_align(bars, segments) |>                     # Change `bars`
  select(bars) |>                                      #   in all three
  unnest(bars) |>                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )


# 2)

oos2 |>
  compmus_gather_timbre() |>
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = basis,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  scale_fill_viridis_c() +                              
  theme_classic()

# 3)

oos2 |>
  compmus_self_similarity(timbre, "cosine") |> 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "", y = "")

```


### Song 2:


```{r}
# Data.Matrix spotify:track:5ZmSq1xJbf1IptikZZgvJ6

dm <- get_track_audio_features("5ZmSq1xJbf1IptikZZgvJ6")

dm <-
  get_tidy_audio_analysis("5ZmSq1xJbf1IptikZZgvJ6") |> # Change URI.
  compmus_align(bars, segments) |>                     # Change `bars`
  select(bars) |>                                      #   in all three
  unnest(bars) |>                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )


# 2)

dm |>
  compmus_gather_timbre() |>
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = basis,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  scale_fill_viridis_c() +                              
  theme_classic()

# 3)

dm |>
  compmus_self_similarity(timbre, "cosine") |> 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "", y = "")

```

### Song 3:

```{r}

# spotify:track:0pajODU8W5ucIXvkJ4FXWG, Pawel's song

pawel <- get_track_audio_features("0pajODU8W5ucIXvkJ4FXWG")

pawel <-
  get_tidy_audio_analysis("0pajODU8W5ucIXvkJ4FXWG") |> # Change URI.
  compmus_align(bars, segments) |>                     # Change `bars`
  select(bars) |>                                      #   in all three
  unnest(bars) |>                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )


# 2)

pawel |>
  compmus_gather_timbre() |>
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = basis,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  scale_fill_viridis_c() +                              
  theme_classic()

# 3)

pawel |>
  compmus_self_similarity(timbre, "cosine") |> 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "", y = "")



```

Week 7
=====================================================================


### Lecture 1

```{r}
anett <- get_playlist_audio_features("", "37i9dQZF1Fa70zA0LneCPK") #<spotify:playlist:37i9dQZF1Fa70zA0LneCPK>

lorah <- get_playlist_audio_features("", "37i9dQZF1FamLjwP9lNgqU") #<spotify:playlist:37i9dQZF1FamLjwP9lNgqU>

io <- get_playlist_audio_features("", "37i9dQZF1Fa3SuuqxqBxeG") #<spotify:playlist:37i9dQZF1Fa3SuuqxqBxeG>



friends <- bind_rows( lorah |> mutate(category = "Lorah"), anett |> mutate(category = "Anett"), io |> mutate(category = "Io") )

```

Column
-----------------------------------------------------------------------

### First Friend's graphs:

```{r}

anett |> ggplot(aes(x = danceability, y = energy, size = loudness, color = mode)) + geom_point()

friends |> ggplot(aes(x = category, y = energy)) + geom_boxplot()

friends |> ggplot(aes(x = category, y = energy)) + geom_violin()

friends |> ggplot(aes(x = danceability, y = energy, size = loudness, color = category)) + geom_point()


```

Week 8
==========================================================================


Column
---------------------------------------------------------------------------


### Lecture 2:

```{r}
# Week Lecture 2:

oos0 <- get_track_audio_features("7D4gttjv3ot3vuc8We5aVE")

oos1 <-
  get_tidy_audio_analysis("7D4gttjv3ot3vuc8We5aVE") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

# 2)

oos1 |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c()
```




